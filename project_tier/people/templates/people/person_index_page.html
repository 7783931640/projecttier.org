{% extends "standard_sidebar_layout.html" %}
{% load wagtailcore_tags wagtailimages_tags people_tags %}

{% block sidebar %}
  <nav class="sidebar-nav section-nav">
    <h3>In this section</h3>
    <ul class="vertical menu">
      {% for section in self.sections %}
        <li class="{% if section.category.is_active %}is-active{% endif %}">
          <a href="#{{section.category.title|slugify}}">{{ section.category.title }}</a>
        </li>
      {% endfor %}
        <li class="{% if section.category.is_active %}is-active{% endif %}">
          <a href="#fellows">Fellows</a>
        </li>
    </ul>
  </nav>
{% endblock %}

{% block main_content %}
  {% if self.body %}
    <div class="row">
      <div class="body-content">
        {{ self.body|richtext }}
      </div>
    </div>
  {% endif %}

  {% if self.fellowship_years %}
    <div class="fellowships"><a name="fellows"></a>
      <h1>Fellows</h1>

      {% with year=page.fellowship_years.0.0 fellows=page.fellowship_years.0.1 %}
        {% include "includes/person_list.html" with group=year|academic_range list=fellows %}
      {% endwith %}

      {% with past_fellows=page.fellowship_years|slice:"1:" %}
        {% if past_fellows %}
          <ul class="accordion" data-accordion data-multi-expand="true" data-allow-all-closed="true">
            {% for year, fellows in past_fellows %}
              <li class="accordion-item" data-accordion-item>
                <a href="#" class="accordion-title">Fellows, {{ year|academic_range }}</a>
                <div class="accordion-content" data-tab-content>
                  {% include "includes/person_list.html" with group=year|academic_range list=fellows %}
                </div>
              </li>
            {% endfor %}
          </ul>
        {% endif %}
      {% endwith %}
    </div>
  {% endif %}

  {% if self.sections %}
    <div class="people">
      <h1>People</h1>

      {% for section in self.sections %}
        <a name="{{section.category.title|slugify}}"></a>
        {% include "includes/person_list.html" with group=section.category.title list=section.people %}
      {% endfor %}
    </div>
  {% endif %}

{% endblock %}
